# 서버 임대 계획 (네이버 클라우드 기준)

## 한눈에 보기
- 월 예상 비용: **1,421,118원**
- 대상 서비스: AI 기반 보안 투자 시뮬레이터 (국내 서비스)
- 구성: WAS 서버 1대, 정적 자산 서버 1대, Cloud DB for MySQL 1대, 공인 IP 2개, DNS 1건

---

## 1. WAS 서버 (웹/API + AI 작업)
- **역할**: 로그인, 데이터 조회, AI 계산, 백그라운드 작업을 모두 맡는 핵심 엔진입니다.
- **선택 사양**
  - 서버 타입: Standard (G3 세대)
  - vCPU 16개, 메모리 64GB
  - SSD 스토리지 1TB
- **용도**
  - 한국투자증권 Open API 기반 주문 시뮬레이션, 위협 대응 규칙 엔진 실행
  - Celery 워커를 통한 AI 추천 산출, LLM 호출 오케스트레이션
  - 사용자 인증, RBAC, 감사 로그 기록 처리
- **필요 사양 근거**
  1. 초당 10건 수준의 투자 시나리오 연산과 LLM 후처리를 병렬로 처리하려면 16코어 CPU와 64GB 메모리가 필요합니다.
  2. Celery 워커, Redis, 모니터링 에이전트를 단일 노드에서 운영해야 장애 시 즉시 복구가 가능하므로 고사양이 필요합니다.
  3. 일 단위로 적재되는 시세 원본·주문 로그·분석 결과가 약 600GB이어서 1TB SSD를 확보해야 보관 주기를 유지할 수 있습니다.

---

## 2. 정적 자산 서버 (Nginx + 대시보드 화면)
- **역할**: 대시보드, 차트 이미지를 빠르게 띄우고, SSL 인증서·로그 수집도 담당합니다.
- **선택 사양**
  - 서버 타입: Standard (G3 세대)
  - vCPU 8개, 메모리 32GB
  - SSD 스토리지 1TB
- **용도**
  - 대시보드 템플릿 렌더링, 차트 이미지 사전 생성, 정적 자산 배포
  - SSL 인증서 관리, 로드 밸런싱, 실시간 로그 뷰어(Dozzle 등) 운영
- **필요 사양 근거**
  1. 시나리오 리포트를 HTML/PDF로 사전 빌드하려면 멀티 스레드 렌더링이 필요해 8코어 CPU가 요구됩니다.
  2. 대시보드 캐시, 사용자별 설정, 빌드 산출물을 메모리에서 유지해 응답 시간을 1초 미만으로 보장하려면 32GB 메모리가 필요합니다.
  3. 정적 자산 버전을 6개월치 보관하고 롤백하기 위해 1TB SSD가 필요합니다.

---

## 3. Cloud DB for MySQL (Managed)
- **역할**: 유저 정보, 시뮬레이션 결과, LLM 응답 기록 등 모든 핵심 데이터를 저장합니다.
- **선택 사양**
  - 플랫폼 타입: VPC / 서버 세대: G3 / 서버 타입: Standard
  - 스펙: vCPU 4개, 메모리 16GB (마스터 1대)
  - 데이터 스토리지: SSD 1,030GB, 백업 스토리지 100GB(자동 백업 7일 보관)
- **용도**
  - 사용자·시나리오 메타데이터, 투자 체결 로그, 위협 이벤트 기록 저장
  - LLM 프롬프트/응답, 토큰 사용량 집계, 감사 이력 테이블 관리
- **필요 사양 근거**
  1. 하루 평균 20GB 규모의 거래 로그와 리포트를 12개월 보관해야 하므로 1TB 스토리지가 필요합니다.
  2. 투자 보고서 작성 시 최대 15개 테이블을 조인하므로 4코어 CPU와 16GB 메모리가 필수입니다.
  3. 7일 주기의 자동 백업을 운영 정책으로 고정했기 때문에 백업 스토리지 100GB가 필요합니다.

---

## 4. 네트워크 & 기타
- 공인 IP 2개: WAS, 정적 서버 각각 1개 (약 8,064원/월)
- Global DNS 1건: 도메인 연결, 쿼리 200만 건 기준 (약 1,430원/월)
- 네트워크 사용량: 국내 리전 내 트래픽 중심, 해외 송출 없음
- 보안/운영: Trivy 이미지 스캔, Docker Compose 기반 장애 복구 스크립트 포함

---

## 예산 맞추기 전략
1. **첫 달부터 풀 스펙**으로 시작해 불확실성을 제거합니다. 안정화 기간 동안은 감가가 아닌 보험 개념으로 보는 편이 낫습니다.
2. 실사용 데이터를 모은 뒤에도 여유 예산은 DR 시스템(백업 서버)이나 모니터링 고도화에 즉시 투입할 수 있습니다.
3. 만약 실제 사용량이 적다면 스펙을 낮춰 비용을 줄일 수도 있지만, 현재는 150만 원 예산 내에서 안정성 확보가 최우선입니다.

> 요약: “조금 과한 것 아니냐?”는 질문을 받더라도, 실제 사고가 나면 손실이 훨씬 큽니다. 처음부터 여유 있는 사양을 확보해 두는 것이 가장 안전하고 빠른 길입니다.
